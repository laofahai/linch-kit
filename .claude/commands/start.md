ðŸš¨ å¼€å§‹å¼€å‘ session - å¿…é¡»ä¸¥æ ¼éµå¾ªæ‰€æœ‰çº¦æŸ

**å¼ºåˆ¶è¦æ±‚:**

- é˜…è¯»å¹¶éµå®ˆ @CLAUDE.md ä¸­çš„æ‰€æœ‰çº¦æŸ
- éµå®ˆ @ai-context/02_Guides/01_Development_Workflow.md ä¸­çš„å¼€å‘æµç¨‹
- å®Œæˆ Graph RAG å¼ºåˆ¶æŸ¥è¯¢ï¼ˆé›¶å®¹å¿è¿è§„ï¼‰

ä»»åŠ¡: $ARGUMENTS

!echo "ðŸ” [$(date '+%H:%M:%S')] è¾“å…¥éªŒè¯å’Œå®‰å…¨æ£€æŸ¥..."
!if [[-z "$ARGUMENTS"]]; then
echo "âŒ é”™è¯¯ï¼šè¯·æä¾›ä»»åŠ¡æè¿°"
exit 1
fi

!echo "ðŸ” [$(date '+%H:%M:%S')] æ£€æŸ¥å½“å‰åˆ†æ”¯çŠ¶æ€..."
!CURRENT_BRANCH=$(git branch --show-current)
!if [[ "$CURRENT_BRANCH" == "main" ]] || [["$CURRENT_BRANCH" == "master"]] || [["$CURRENT_BRANCH" == "develop"]]; then
echo "âŒ é”™è¯¯ï¼šä¸èƒ½åœ¨ä¿æŠ¤åˆ†æ”¯ $CURRENT_BRANCH ä¸Šå·¥ä½œ"
echo "ðŸ’¡ å»ºè®®ï¼šè¿è¡Œ /new-branch [åŠŸèƒ½å] åˆ›å»ºåŠŸèƒ½åˆ†æ”¯"
exit 1
fi

!echo "ðŸ§  [$(date '+%H:%M:%S')] å¼€å§‹ Claude æ™ºèƒ½ä»»åŠ¡å¤æ‚åº¦è¯„ä¼°..."
!echo "ðŸ“‹ å°†åŸºäºŽ Graph RAG æŸ¥è¯¢ç»“æžœå’Œä»»åŠ¡è¯­ä¹‰è¿›è¡Œæ™ºèƒ½åˆ†æž"
!echo "ðŸŽ¯ è¯„ä¼°å°†åœ¨ Graph RAG æŸ¥è¯¢å®ŒæˆåŽè¿›è¡Œ"

!echo "ðŸ—ï¸ [$(date '+%H:%M:%S')] å¼€å§‹ Claude ç»¼åˆæž¶æž„åˆ†æž..."

!echo "ðŸ“‹ æ­¥éª¤1: æ‰§è¡Œ Graph RAG çŽ°æœ‰å®žçŽ°æŸ¥è¯¢..."
!GRAPH_RAG_RESULT=$(bun run ai:session query "$ARGUMENTS" 2>&1)
!if [[$? -ne 0]]; then
echo "ðŸš¨ FATAL: Graph RAG æŸ¥è¯¢å¤±è´¥ - è¿™æ˜¯é›¶å®¹å¿è¿è§„"
echo "ðŸ“‹ é”™è¯¯è¯¦æƒ…: $GRAPH_RAG_RESULT"
echo "ðŸ›‘ Claude å¿…é¡»åŸºäºŽé¡¹ç›®ä¸Šä¸‹æ–‡è¿›è¡Œå¼€å‘ï¼ŒæŸ¥è¯¢å¤±è´¥åˆ™åœæ­¢"
exit 1
fi
!echo "âœ… Graph RAG æŸ¥è¯¢å®Œæˆï¼Œæ‰¾åˆ°ç›¸å…³å®žçŽ°"

!echo "ðŸ§  [$(date '+%H:%M:%S')] æ‰§è¡Œ Claude æ™ºèƒ½ä»»åŠ¡å¤æ‚åº¦è¯„ä¼°..."

!cat > .claude/temp-assessment-prompt.txt << EOF

# LinchKit ä»»åŠ¡å¤æ‚åº¦æ™ºèƒ½è¯„ä¼° Prompt

## è§’è‰²å®šä¹‰

ä½ æ˜¯ä¸€ä¸ªèµ„æ·±çš„ LinchKit è½¯ä»¶æž¶æž„å¸ˆï¼Œä¸“é—¨è´Ÿè´£è¯„ä¼°å¼€å‘ä»»åŠ¡çš„å¤æ‚åº¦ã€‚ä½ çš„åˆ¤æ–­å°†ç›´æŽ¥å½±å“åŽç»­çš„è®¾è®¡æµç¨‹é€‰æ‹©å’Œå¼€å‘ç­–ç•¥ã€‚

## ä»»åŠ¡çº§åˆ«æ ‡å‡†

### T1 çº§åˆ«ï¼šè±å…çº§ (Exempt Level)

- **å½±å“èŒƒå›´**ï¼š1-3 ä¸ªæ–‡ä»¶
- **é¢„è®¡æ—¶é—´**ï¼š< 2 å°æ—¶
- **æž¶æž„å½±å“**ï¼šæ— æž¶æž„å˜æ›´
- **è®¾è®¡éœ€æ±‚**ï¼šæ— éœ€è®¾è®¡ï¼Œæœ‰æ¸…æ™°çš„å®žçŽ°è·¯å¾„
- **å…¸åž‹ç¤ºä¾‹**ï¼šä¿®å¤æ‹¼å†™ã€è°ƒæ•´æ ·å¼ã€å¢žåŠ æ³¨é‡Šã€ç®€å•bugä¿®å¤

### T2 çº§åˆ«ï¼šè½»é‡çº§ (Lite Level)

- **å½±å“èŒƒå›´**ï¼šå•ä¸ªåŒ…å†…å¤šä¸ªæ–‡ä»¶ï¼Œæˆ–è·¨åŒ…å°‘é‡æ–‡ä»¶
- **é¢„è®¡æ—¶é—´**ï¼š2-8 å°æ—¶
- **æž¶æž„å½±å“**ï¼šå±€éƒ¨æž¶æž„è°ƒæ•´ï¼Œä¸æ¶‰åŠæ ¸å¿ƒè®¾è®¡å˜æ›´
- **è®¾è®¡éœ€æ±‚**ï¼šéœ€è¦ç®€è¦è®¾è®¡è§„åˆ’
- **å…¸åž‹ç¤ºä¾‹**ï¼šåŠŸèƒ½å¢žå¼ºã€å±€éƒ¨é‡æž„ã€å¤æ‚bugä¿®å¤ã€æ€§èƒ½ä¼˜åŒ–

### T3 çº§åˆ«ï¼šå¼ºåˆ¶çº§ (Full Level)

- **å½±å“èŒƒå›´**ï¼šè·¨å¤šä¸ªæ ¸å¿ƒåŒ…ï¼Œæˆ–å¼•å…¥æ–°ä¾èµ–/æ¨¡å—
- **é¢„è®¡æ—¶é—´**ï¼š> 1 å¤©ï¼ˆ8+ å°æ—¶ï¼‰
- **æž¶æž„å½±å“**ï¼šæ¶‰åŠæ ¸å¿ƒæž¶æž„å˜æ›´ã€æ–°æ¨¡å—è®¾è®¡æˆ–é‡å¤§é‡æž„
- **è®¾è®¡éœ€æ±‚**ï¼šå¿…é¡»è¿›è¡Œå®Œæ•´æ–¹æ¡ˆè®¾è®¡
- **å…¸åž‹ç¤ºä¾‹**ï¼šæ–°åŠŸèƒ½æ¨¡å—ã€æ–°é¡µé¢ã€APIé›†æˆã€æž¶æž„é‡æž„

## è¯„ä¼°ä»»åŠ¡

**ç”¨æˆ·ä»»åŠ¡æè¿°**ï¼š$ARGUMENTS

**Graph RAG æŸ¥è¯¢ç»“æžœ**ï¼š
$GRAPH_RAG_RESULT

**è¯·åŸºäºŽä¸Šè¿°ä¿¡æ¯è¿›è¡Œæ™ºèƒ½è¯„ä¼°ï¼Œå¹¶ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºç»“æžœï¼š**

{
"taskLevel": "T1|T2|T3",
"confidence": "high|medium|low",
"reasoning": "è¯¦ç»†çš„åˆ¤æ–­ç†ç”±ï¼ŒåŒ…æ‹¬è€ƒè™‘çš„å…³é”®å› ç´ å’Œå†³ç­–é€»è¾‘",
"estimatedFilesToChange": æ•°å­—,
"estimatedTimeHours": æ•°å­—,
"potentialRisks": [
"å…·ä½“é£Žé™©æè¿°1",
"å…·ä½“é£Žé™©æè¿°2"
],
"recommendedActions": [
"å»ºè®®çš„å…·ä½“è¡ŒåŠ¨1",
"å»ºè®®çš„å…·ä½“è¡ŒåŠ¨2"
],
"graphRagFindings": "åŸºäºŽGraph RAGæŸ¥è¯¢çš„å…³é”®å‘çŽ°æ€»ç»“",
"architectureImpact": "å¯¹LinchKitæž¶æž„çš„å…·ä½“å½±å“åˆ†æž"
}
EOF

!echo "ðŸš¨ æ­£åœ¨è¿›è¡Œ Claude æ™ºèƒ½è¯„ä¼°ï¼Œè¯·ç­‰å¾…..."
!echo "ðŸ“ Claude æ­£åœ¨åˆ†æžä»»åŠ¡è¯­ä¹‰å’Œ Graph RAG ç»“æžœ..."
!echo "â±ï¸ é¢„è®¡éœ€è¦ 10-15 ç§’å®Œæˆè¯„ä¼°"

!echo "ðŸ“‹ æ­¥éª¤2: æŸ¥è¯¢é¡¹ç›®æž¶æž„æ–‡æ¡£..."
!if [[-d "ai-context"]]; then
echo "âœ… ai-context æ–‡æ¡£å¯ç”¨ï¼ŒClaude å°†åˆ†æžæž¶æž„çº¦æŸ"
echo "ðŸ“„ å…³é”®æ–‡æ¡£:"
echo " â€¢ ai-context/01_Architecture/03_Package_Architecture.md (critical)"
echo " â€¢ ai-context/01_Architecture/07_Strategic_Architecture_Evolution.md (critical)"
echo " â€¢ ai-context/02_Guides/01_Development_Workflow.md (constraints)"
else
echo "âš ï¸ ai-context ç›®å½•ä¸å­˜åœ¨ï¼Œæž¶æž„åˆ†æžå—é™"
fi

!echo "ðŸ“‹ æ­¥éª¤3: å‡†å¤‡æ™ºèƒ½ä»£ç æ¨¡å¼åˆ†æž..."
!echo "ðŸ§  Claude å°†åŸºäºŽ Graph RAG æŸ¥è¯¢ç»“æžœæ™ºèƒ½åˆ†æžçŽ°æœ‰ä»£ç æ¨¡å¼"
!echo "ðŸ” Claude å°†è‡ªåŠ¨è¯†åˆ«å¯å¤ç”¨çš„ LinchKit åŒ…å’Œç»„ä»¶"

!echo "ðŸ“‹ æ­¥éª¤4: Claude æž¶æž„åˆ†æžæ‰¿è¯ºæ¿€æ´»..."
!cat > .claude/current-session-analysis.md << EOF

# Claude æž¶æž„åˆ†æžæŠ¥å‘Š - $(date '+%Y-%m-%d %H:%M:%S')

## ä»»åŠ¡: $ARGUMENTS

## Graph RAG æŸ¥è¯¢ç»“æžœ

å·²å®Œæˆé¡¹ç›®ä¸Šä¸‹æ–‡æŸ¥è¯¢ï¼Œå‘çŽ°ç›¸å…³çŽ°æœ‰å®žçŽ°

## æž¶æž„æ–‡æ¡£åˆ†æž

- ai-context æ–‡æ¡£å¯ç”¨
- å°†éµå¾ª LinchKit å½“å‰æž¶æž„åŽŸåˆ™
- é¿å…é‡å¤å®žçŽ°çŽ°æœ‰åŠŸèƒ½

## Claude å¼ºåˆ¶æ‰¿è¯º

æˆ‘æ‰¿è¯ºåœ¨æœ¬æ¬¡å¼€å‘ä¸­ï¼š

1. âœ… åŸºäºŽ Graph RAG æŸ¥è¯¢ç»“æžœå¤ç”¨çŽ°æœ‰å®žçŽ°
2. âœ… éµå¾ª ai-context ä¸­çš„æž¶æž„çº¦æŸ
3. âœ… åˆ†æžçŽ°æœ‰ä»£ç æ¨¡å¼åŽå†ç¼–ç 
4. âœ… ä¼˜å…ˆä½¿ç”¨ LinchKit æ ¸å¿ƒåŒ…åŠŸèƒ½
5. âœ… å‘çŽ°è¿è§„æ—¶ç«‹å³åœæ­¢å¹¶çº æ­£

## åˆ†æžçŠ¶æ€: å·²å®Œæˆ âœ“

çŽ°åœ¨å¯ä»¥åŸºäºŽå®Œæ•´é¡¹ç›®ä¸Šä¸‹æ–‡å¼€å§‹æ™ºèƒ½å¼€å‘
EOF

!echo "ðŸ“š [$(date '+%H:%M:%S')] æ‰§è¡Œè¡¥å…… Context7 æŸ¥è¯¢..."
!if command -v context7 &> /dev/null; then
context7 "$ARGUMENTS" || echo "âš ï¸ Context7 æŸ¥è¯¢å¤±è´¥ï¼Œç»§ç»­ä½¿ç”¨ Graph RAG ç»“æžœ"
else
echo "âš ï¸ Context7 æœªå®‰è£…ï¼Œè·³è¿‡æŸ¥è¯¢"
fi

!echo "ðŸ¤ [$(date '+%H:%M:%S')] æ£€æŸ¥æ˜¯å¦éœ€è¦ Gemini åå•†..."
!if [[$ARGUMENTS =~ (è®¾è®¡|æž¶æž„|æŠ€æœ¯é€‰åž‹|æ–¹æ¡ˆ|å¤æ‚)]]; then
echo "ðŸ’¡ å»ºè®®ä¸ŽGeminiåå•†è®¾è®¡æœ€ä½³å®žè·µ"
echo " ä½¿ç”¨å‘½ä»¤ï¼šä¸ŽGeminiåå•† $ARGUMENTS"
fi

!echo "ðŸ“‹ [$(date '+%H:%M:%S')] æ£€æŸ¥åŒ…å¤ç”¨æƒ…å†µ..."
!if [[-f "tools/dev/check-reuse.mjs"]]; then
bun run deps:check "$ARGUMENTS" || echo "âš ï¸ åŒ…å¤ç”¨æ£€æŸ¥å¤±è´¥"
else
echo "âš ï¸ åŒ…å¤ç”¨æ£€æŸ¥è„šæœ¬ä¸å­˜åœ¨"
fi

!echo "ðŸ¤– [$(date '+%H:%M:%S')] æ¿€æ´» Claude è‡ªæˆ‘ç›‘ç£æœºåˆ¶..."
!cat > .claude/claude-session-monitor.md << EOF

# Claude è‡ªæˆ‘ç›‘ç£ - å½“å‰ä¼šè¯å¼ºåˆ¶çº¦æŸ

## é›¶å®¹å¿çº¦æŸ (è¿åå³ç»ˆæ­¢)

1. ðŸš« ä»»ä½•ç¼–ç å‰å¿…é¡»å…ˆåŸºäºŽ Graph RAG æŸ¥è¯¢ç»“æžœåˆ†æžçŽ°æœ‰å®žçŽ°
2. ðŸš« ç¦æ­¢é‡å¤å®žçŽ°å·²å­˜åœ¨çš„ LinchKit åŠŸèƒ½
3. ðŸš« ç¦æ­¢ä½¿ç”¨ console.log/console.errorï¼Œå¿…é¡»ç”¨ @linch-kit/core logger
4. ðŸš« ç¦æ­¢è·³è¿‡ ai-context æž¶æž„æ–‡æ¡£åˆ†æž
5. ðŸš« ç¦æ­¢åœ¨ä¿æŠ¤åˆ†æ”¯ç›´æŽ¥å·¥ä½œ

## è‡ªæˆ‘æ£€æŸ¥æœºåˆ¶

ç¼–ç å‰è‡ªé—®ï¼š

- "æˆ‘æ˜¯å¦å·²æŸ¥è¯¢å¹¶åˆ†æžäº†çŽ°æœ‰ç›¸å…³å®žçŽ°ï¼Ÿ"
- "æˆ‘æ˜¯å¦ç¡®è®¤æ²¡æœ‰é‡å¤å®žçŽ°çŽ°æœ‰åŠŸèƒ½ï¼Ÿ"
- "æˆ‘æ˜¯å¦éµå¾ªäº†å½“å‰ LinchKit æž¶æž„åŽŸåˆ™ï¼Ÿ"
- "æˆ‘æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„ LinchKit æ ¸å¿ƒåŒ…ï¼Ÿ"

## è¿è§„å¤„ç†

å‘çŽ°è¿è§„æ—¶å¿…é¡»ï¼š

1. ç«‹å³åœæ­¢å½“å‰ä»»åŠ¡
2. å…¬å¼€æ‰¿è®¤è¿è§„è¡Œä¸º
3. è§£é‡Šè¿è§„åŽŸå› 
4. é‡æ–°æ‰§è¡Œæ­£ç¡®çš„åˆ†æžæµç¨‹

## ä¼šè¯çŠ¶æ€: æž¶æž„åˆ†æžå·²å®Œæˆ âœ“

EOF

!echo "ðŸŽ¨ [$(date '+%H:%M:%S')] Claude æ™ºèƒ½è¯„ä¼°å®Œæˆï¼Œå‡†å¤‡å¯åŠ¨ç›¸åº”è®¾è®¡æµç¨‹..."

!echo "ðŸ“‹ æç¤ºï¼šClaude å°†åŸºäºŽæ™ºèƒ½è¯„ä¼°ç»“æžœè‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„è®¾è®¡æµç¨‹"
!echo "ðŸ§  Claude çŽ°åœ¨æ‹¥æœ‰å®Œæ•´çš„é¡¹ç›®ä¸Šä¸‹æ–‡å’Œä»»åŠ¡å¤æ‚åº¦åˆ†æž"
!echo "ðŸš€ è¯· Claude ç»§ç»­åŸºäºŽè¯„ä¼°ç»“æžœè¿›è¡ŒåŽç»­å¼€å‘æµç¨‹"

!echo "ðŸ“Š å¯é€‰ï¼šClaude å¯ä»¥çŽ°åœ¨å°±å±•ç¤ºè¯„ä¼°ç»“æžœå’Œå»ºè®®çš„è®¾è®¡æµç¨‹"

!echo "ðŸ’¾ [$(date '+%H:%M:%S')] å‡†å¤‡è®°å½•ç”¨æˆ·åé¦ˆå’Œè¯„ä¼°ç»“æžœ..."
!mkdir -p .claude/feedback-logs
!echo "ðŸ—‚ï¸ åé¦ˆæ—¥å¿—ç›®å½•å·²å‡†å¤‡ï¼š.claude/feedback-logs/"

!echo ""
!echo "âœ… [$(date '+%H:%M:%S')] Claude ç»¼åˆåˆ†æžå®Œæˆï¼Œè®¾è®¡æµç¨‹å·²å¯åŠ¨ï¼"
!echo "ðŸš¨ æé†’: Claude å·²æ‰¿è¯ºéµå¾ªæ‰€æœ‰æž¶æž„çº¦æŸï¼ŒåŸºäºŽå®Œæ•´é¡¹ç›®ä¸Šä¸‹æ–‡è¿›è¡Œå¼€å‘"
!echo "ðŸ“‹ ä¸‹ä¸€æ­¥ï¼šClaude å°†å±•ç¤ºæ™ºèƒ½è¯„ä¼°ç»“æžœå¹¶ç­‰å¾…æ‚¨çš„ç¡®è®¤"
